<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Á•ûÁµåË°∞Âº± ‚Äî MEMORIA</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Noto+Serif+JP:wght@300;400&display=swap" rel="stylesheet">
<style>
  :root {
    --felt: #1a3d2b;
    --felt-light: #22503a;
    --gold: #c9a84c;
    --gold-light: #e8c97a;
    --cream: #f5f0e8;
    --card-back: #1c2e4a;
    --card-back-pattern: #243a5e;
    --red: #c0392b;
    --dark: #0d1f16;
    --shadow: rgba(0,0,0,0.6);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--dark);
    background-image:
      radial-gradient(ellipse at 50% 0%, #1a3d2b 0%, #0d1f16 70%);
    min-height: 100vh;
    font-family: 'Noto Serif JP', serif;
    color: var(--cream);
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 24px 16px 40px;
    overflow-x: hidden;
  }

  /* Subtle felt texture */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='4'%3E%3Ccircle cx='1' cy='1' r='0.5' fill='rgba(255,255,255,0.015)'/%3E%3Ccircle cx='3' cy='3' r='0.5' fill='rgba(255,255,255,0.015)'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 0;
  }

  header {
    text-align: center;
    margin-bottom: 28px;
    position: relative;
    z-index: 1;
  }

  .title {
    font-family: 'Cinzel', serif;
    font-size: clamp(2rem, 6vw, 3.2rem);
    font-weight: 700;
    letter-spacing: 0.15em;
    background: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 50%, var(--gold) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: none;
    line-height: 1.1;
  }

  .subtitle {
    font-family: 'Noto Serif JP', serif;
    font-size: 0.8rem;
    letter-spacing: 0.3em;
    color: rgba(201,168,76,0.6);
    margin-top: 4px;
  }

  .divider {
    width: 200px;
    height: 1px;
    background: linear-gradient(to right, transparent, var(--gold), transparent);
    margin: 10px auto 0;
  }

  .hud {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-bottom: 24px;
    position: relative;
    z-index: 1;
    flex-wrap: wrap;
    justify-content: center;
  }

  .score-box {
    background: rgba(255,255,255,0.04);
    border: 1px solid rgba(201,168,76,0.3);
    border-radius: 8px;
    padding: 10px 28px;
    text-align: center;
    backdrop-filter: blur(4px);
  }

  .score-label {
    font-size: 0.65rem;
    letter-spacing: 0.25em;
    color: rgba(201,168,76,0.7);
    text-transform: uppercase;
  }

  .score-value {
    font-family: 'Cinzel', serif;
    font-size: 2rem;
    color: var(--gold-light);
    line-height: 1.1;
  }

  .score-denom {
    font-size: 0.75rem;
    color: rgba(245,240,232,0.4);
  }

  .reset-btn {
    font-family: 'Cinzel', serif;
    font-size: 0.8rem;
    letter-spacing: 0.2em;
    color: var(--gold);
    background: transparent;
    border: 1px solid rgba(201,168,76,0.5);
    border-radius: 6px;
    padding: 12px 28px;
    cursor: pointer;
    transition: all 0.25s ease;
    text-transform: uppercase;
  }

  .reset-btn:hover {
    background: rgba(201,168,76,0.1);
    border-color: var(--gold);
    box-shadow: 0 0 20px rgba(201,168,76,0.2);
  }

  .reset-btn:active { transform: scale(0.97); }

  /* Card Grid */
  .board {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: clamp(8px, 2vw, 14px);
    width: 100%;
    max-width: 520px;
    position: relative;
    z-index: 1;
  }

  /* Card */
  .card {
    aspect-ratio: 2/3;
    cursor: pointer;
    perspective: 800px;
    border-radius: 10px;
  }

  .card-inner {
    width: 100%;
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.45s cubic-bezier(0.4, 0, 0.2, 1);
    border-radius: 10px;
  }

  .card.flipped .card-inner,
  .card.matched .card-inner {
    transform: rotateY(180deg);
  }

  .card-face {
    position: absolute;
    inset: 0;
    border-radius: 10px;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }

  /* Card Back */
  .card-back {
    background: var(--card-back);
    border: 1px solid rgba(255,255,255,0.1);
    box-shadow: 0 4px 20px var(--shadow), inset 0 0 0 6px rgba(255,255,255,0.03);
  }

  .card-back::before {
    content: '';
    position: absolute;
    inset: 6px;
    border: 1px solid rgba(201,168,76,0.25);
    border-radius: 6px;
  }

  .card-back::after {
    content: '‚ú¶';
    font-size: 1.4rem;
    color: rgba(201,168,76,0.35);
  }

  /* Diamond pattern on back */
  .card-back .pattern {
    position: absolute;
    inset: 0;
    background-image:
      repeating-linear-gradient(45deg,
        rgba(255,255,255,0.015) 0px,
        rgba(255,255,255,0.015) 1px,
        transparent 1px,
        transparent 10px),
      repeating-linear-gradient(-45deg,
        rgba(255,255,255,0.015) 0px,
        rgba(255,255,255,0.015) 1px,
        transparent 1px,
        transparent 10px);
    border-radius: 10px;
  }

  /* Card Front */
  .card-front {
    background: var(--cream);
    transform: rotateY(180deg);
    border: 1px solid rgba(0,0,0,0.1);
    box-shadow: 0 6px 24px var(--shadow);
    flex-direction: column;
    position: relative;
  }

  .card-front .corner-top {
    position: absolute;
    top: 6px;
    left: 8px;
    display: flex;
    flex-direction: column;
    align-items: center;
    line-height: 1;
    gap: 1px;
  }

  .card-front .corner-bottom {
    position: absolute;
    bottom: 6px;
    right: 8px;
    display: flex;
    flex-direction: column;
    align-items: center;
    line-height: 1;
    gap: 1px;
    transform: rotate(180deg);
  }

  .card-front .corner-num {
    font-family: 'Cinzel', serif;
    font-weight: 700;
    font-size: clamp(1rem, 3vw, 1.3rem);
    line-height: 1;
  }

  .card-front .corner-sym {
    font-size: clamp(0.8rem, 2.5vw, 1rem);
    line-height: 1;
  }

  .card-front .center {
    font-size: clamp(2.2rem, 7vw, 3.6rem);
    line-height: 1;
    user-select: none;
  }

  .card-front.red .corner-num,
  .card-front.red .corner-sym,
  .card-front.red .center { color: var(--red); }

  .card-front.black .corner-num,
  .card-front.black .corner-sym,
  .card-front.black .center { color: #1a1a2e; }

  /* Matched card style */
  .card.matched .card-front {
    background: #e8f5e9;
  }

  .card.matched .card-inner {
    box-shadow: 0 0 0 2px #4caf50, 0 4px 20px rgba(76,175,80,0.3);
    border-radius: 10px;
  }

  .card:not(.flipped):not(.matched):hover .card-inner {
    transform: translateY(-3px) rotateY(4deg);
    box-shadow: 0 8px 30px rgba(201,168,76,0.25);
  }

  /* Clear overlay */
  .clear-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.82);
    z-index: 100;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    gap: 20px;
    backdrop-filter: blur(6px);
  }

  .clear-overlay.show { display: flex; }

  .clear-title {
    font-family: 'Cinzel', serif;
    font-size: clamp(2.5rem, 10vw, 5rem);
    font-weight: 700;
    background: linear-gradient(135deg, var(--gold), var(--gold-light), var(--gold));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-align: center;
    animation: pulse 1.2s ease infinite alternate;
  }

  .clear-sub {
    font-size: 1rem;
    color: rgba(245,240,232,0.7);
    letter-spacing: 0.2em;
    text-align: center;
  }

  .clear-btn {
    font-family: 'Cinzel', serif;
    font-size: 0.9rem;
    letter-spacing: 0.2em;
    color: var(--dark);
    background: linear-gradient(135deg, var(--gold), var(--gold-light));
    border: none;
    border-radius: 8px;
    padding: 14px 40px;
    cursor: pointer;
    text-transform: uppercase;
    transition: transform 0.2s, box-shadow 0.2s;
    margin-top: 8px;
  }

  .clear-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 24px rgba(201,168,76,0.5);
  }

  @keyframes pulse {
    from { filter: brightness(1); }
    to { filter: brightness(1.3); }
  }

  /* Confetti particles */
  .confetti {
    position: fixed;
    top: -10px;
    width: 8px;
    height: 8px;
    border-radius: 2px;
    animation: fall linear forwards;
    z-index: 101;
  }

  @keyframes fall {
    to { transform: translateY(110vh) rotate(720deg); opacity: 0; }
  }
</style>
</head>
<body>

<header>
  <div class="title">MEMORIA</div>
  <div class="subtitle">Á•ûÁµåË°∞Âº±</div>
  <div class="divider"></div>
</header>

<div class="hud">
  <div class="score-box">
    <div class="score-label">Áç≤Âæó„Éö„Ç¢</div>
    <div class="score-value"><span id="score">0</span><span class="score-denom">/8</span></div>
  </div>
  <button class="reset-btn" onclick="initGame()">‚Ü∫ „É™„Çª„ÉÉ„Éà</button>
</div>

<div class="board" id="board"></div>

<div class="clear-overlay" id="clearOverlay">
  <div class="clear-title">üéâ „ÇØ„É™„Ç¢ÔºÅ</div>
  <div class="clear-sub">ÂÖ®„Å¶„ÅÆ„Éö„Ç¢„ÇíÊèÉ„Åà„Åæ„Åó„Åü</div>
  <button class="clear-btn" onclick="initGame(); document.getElementById('clearOverlay').classList.remove('show')">„ÇÇ„ÅÜ‰∏ÄÂ∫¶„Éó„É¨„Ç§</button>
</div>

<script>
const CARDS = [
  { id: 0, symbol: '‚ô†', label: 'A', color: 'black' },
  { id: 1, symbol: '‚ô•', label: 'K', color: 'red'   },
  { id: 2, symbol: '‚ô¶', label: 'Q', color: 'red'   },
  { id: 3, symbol: '‚ô£', label: 'J', color: 'black' },
  { id: 4, symbol: '‚ô†', label: '10',color: 'black' },
  { id: 5, symbol: '‚ô•', label: '9', color: 'red'   },
  { id: 6, symbol: '‚ô¶', label: '8', color: 'red'   },
  { id: 7, symbol: '‚ô£', label: '7', color: 'black' },
];

let deck = [];
let flipped = [];
let matched = 0;
let locked = false;

function shuffle(arr) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

function initGame() {
  deck = shuffle([...CARDS, ...CARDS]);
  flipped = [];
  matched = 0;
  locked = false;
  document.getElementById('score').textContent = '0';
  renderBoard();
}

function renderBoard() {
  const board = document.getElementById('board');
  board.innerHTML = '';
  deck.forEach((card, idx) => {
    const el = document.createElement('div');
    el.className = 'card';
    el.dataset.idx = idx;
    el.innerHTML = `
      <div class="card-inner">
        <div class="card-face card-back">
          <div class="pattern"></div>
        </div>
        <div class="card-face card-front ${card.color}">
          <div class="corner-top">
            <span class="corner-num">${card.label}</span>
            <span class="corner-sym">${card.symbol}</span>
          </div>
          <span class="center">${card.symbol}</span>
          <div class="corner-bottom">
            <span class="corner-num">${card.label}</span>
            <span class="corner-sym">${card.symbol}</span>
          </div>
        </div>
      </div>`;
    el.addEventListener('click', () => onCardClick(el, idx));
    board.appendChild(el);
  });
}

function onCardClick(el, idx) {
  if (locked) return;
  if (el.classList.contains('flipped') || el.classList.contains('matched')) return;
  if (flipped.length >= 2) return;

  el.classList.add('flipped');
  flipped.push({ el, idx });

  if (flipped.length === 2) {
    locked = true;
    const [a, b] = flipped;
    const cardA = deck[a.idx];
    const cardB = deck[b.idx];

    if (cardA.id === cardB.id) {
      // Match!
      setTimeout(() => {
        a.el.classList.add('matched');
        b.el.classList.add('matched');
        matched++;
        document.getElementById('score').textContent = matched;
        flipped = [];
        locked = false;
        if (matched === 8) showClear();
      }, 500);
    } else {
      // No match
      setTimeout(() => {
        a.el.classList.remove('flipped');
        b.el.classList.remove('flipped');
        flipped = [];
        locked = false;
      }, 1000);
    }
  }
}

function showClear() {
  setTimeout(() => {
    document.getElementById('clearOverlay').classList.add('show');
    spawnConfetti();
  }, 400);
}

function spawnConfetti() {
  const colors = ['#c9a84c','#e8c97a','#4caf50','#c0392b','#3498db','#9b59b6','#f39c12'];
  for (let i = 0; i < 60; i++) {
    setTimeout(() => {
      const c = document.createElement('div');
      c.className = 'confetti';
      c.style.cssText = `
        left: ${Math.random()*100}vw;
        background: ${colors[Math.floor(Math.random()*colors.length)]};
        animation-duration: ${1.5 + Math.random()*2}s;
        animation-delay: ${Math.random()*0.5}s;
        width: ${6 + Math.random()*8}px;
        height: ${6 + Math.random()*8}px;
      `;
      document.body.appendChild(c);
      setTimeout(() => c.remove(), 3500);
    }, i * 30);
  }
}

initGame();
</script>
</body>
</html>
